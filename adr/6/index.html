<!DOCTYPE html>
<html>

<head>
    <title>ðŸ—¶â‰½ ADR-6. Transcripts - Wapaganda Project Docs</title>
    <style>
      /* load heading font */
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@700');

      /* load body font */
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=Noto Sans:ital,wght@700');

      /* load mono font */
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:wght@400');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:ital,wght@400');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:wght@700');
      @import url('https://fonts.googleapis.com/css2?family=JetBrains Mono:ital,wght@700');

      /* load emoji font */
      @font-face {
        font-family: "Noto Color Emoji";
        src: url('../../assets/fonts/emoji/NotoColorEmoji-Regular.ttf');
        font-weight: 400;
      }
  
      :root {
        /* colors */
        --primary: #05b2dc;
        --secondary: #ef9B0f;
        --tertiary: #ef3e36;
        /* shades */
        --base: #ffffff;
        --mantle: #f5f4f5;
        --crust: #d4d2d5;
        --overlay: #aBaBaE;
        --footer: #000000cc;
        /* text */
        --text: #343233;
        --hltext: #ffffff;
        color: var(--text);
        /* background-specific text */
        --primary-text: var(--hltext);
        --secondary-text: var(--hltext);
        --tertiary-text: var(--hltext);
        --base-text: var(--text);
        --mantle-text: var(--text);
        --crust-text: var(--text);
        --overlay-text: var(--hltext);
        --footer-text: var(--hltext);
        /* fonts */
        --heading: Poppins, Noto Color Emoji;
        --body: Noto Sans, Noto Color Emoji;
        --mono: JetBrains Mono, Noto Color Emoji;
        font-family: var(--body); 
      }
      /* dark mode */
      @media (prefers-color-scheme: dark) {
        :root {
          /* colors */
          --primary: #05b2dc;
          --secondary: #ef9B0f;
          --tertiary: #ef3e36;
          /* shades */
          --base: #343233;
          --mantle: #373536;
          --crust: #3E3C3D;
          --overlay: #646461;
          --footer: #00000022;
          /* text */
          --text: #ffffff;
          --hltext: #343233;
          color: var(--text);
          /* background-specific text */
          --primary-text: var(--text);
          --secondary-text: var(--text);
          --tertiary-text: var(--text);
          --base-text: var(--text);
          --mantle-text: var(--text);
          --crust-text: var(--text);
          --overlay-text: var(--hltext);
          --footer-text: var(--text);
        }
      }
      /* style settings */
      header#header {
        grid-template-columns: 8rem auto 8rem;
      }
      body#background {
        background: fixed center/cover var(--base);
        
        
      }
      #background-gradient {
        background: linear-gradient(
          45deg, 
          color-mix(in srgb, var(--mantle) 80%, transparent), transparent, color-mix(in srgb, var(--crust) 20%, transparent)
        );
      }
      content#content {
        padding: 0 3rem;
        background: color-mix(in srgb, var(--base) 0%, transparent);
        border-left: none;
        border-right: none;
      }
      #avatar {
        
        border-radius: 1rem;
        
      }
      footer#footer a {
        color: #ef9B0f;
      }
      footer#footer a:hover {
        color: #ef3e36;
      }
    </style>
    <link rel="icon" type="image/x-icon" href=assets/landing-favicon.png>
    <link href="../../css/style.css" rel="stylesheet">
    <link href="../../css/responsivity.css" rel="stylesheet">  
    <script src="../../search/main.js"></script>
    <script src="https://kit.fontawesome.com/b57355f8ac.js" crossorigin="anonymous"></script>
    <script id="altmetric-embed-js" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/altmetric_badges-e7ba41a192efc3e63f5d48f8a1916dec4b1b49c01075bc7b39481408957b3b28.js"></script>
    <link id="altmetric-embed-css" rel="stylesheet" type="text/css" href="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed-59614f5c46b49b21eeef3bb28c4fb38d1e7069e8d014752fcb66e84942556802.css">
  </head>

<body id="background">
  <div id="background-gradient"></div>
  <content id="content">
  
  <header id="article-header">
    <a href=../.. id="return-home">
        <i class="fa fa-arrow-left" alt="â‡¦"></i> Home
    </a>
    <h1 id="title">ðŸ—¶â‰½ ADR-6. Transcripts</h1>
</header>
  
  <main id="page">
    <nav class="vertical" id="toc">

<ul>

<li class="nav-item">
<a href="#context">Context</a>
    
    <ul>
    
    </ul>
    
</li>

<li class="nav-item">
<a href="#decision">Decision</a>
    
    <ul>
    
    
    <li class="nav-subitem">
    <a href="#transcript-flow">Transcript Flow</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#storage">Storage</a>
    </li>
    
    
    
    <li class="nav-subitem">
    <a href="#auxiliary-database">Auxiliary database</a>
    </li>
    
    
    </ul>
    
</li>

<li class="nav-item">
<a href="#status">Status</a>
    
    <ul>
    
    </ul>
    
</li>

<li class="nav-item">
<a href="#consequence">Consequence</a>
    
    <ul>
    
    </ul>
    
</li>

</ul>

</nav>
    <h2 id="context">Context</h2>
<p>One of the W's most important parts has to do with the various media segments (i.e. talk shows, streams, YouTube videos etc.). Until recently, the main focus in this area was on indicating participants, which is just barely enough to make it useful.</p>
<p>Transcripts - <em>text representation of the specific episodes of the relevant media segments</em> - make it significantly more useful. With <a href="https://github.com/openai/whisper">whisper</a>, an open-source, free-to-use software doing speech recognition of high quality, it is possible to produce transcripts for every relevant media episode in (semi-)automated fashion.</p>
<p>Whisper is a machine-learning tool that uses pre-compiled downloadable models (<code>tiny</code> â†’ <code>small</code> â†’ <code>medium</code> â†’ <code>large</code>). The choice of model effects 2 things: <strong>processing time</strong> and <strong>result quality</strong>.</p>
<p>The quality of the output is pretty great even with <code>medium</code> model (\~95%), and <code>large</code> model does an almost perfect job (\~99%). Processing time is approximately 3x and 10x on the media duration, respectively. These figures are not exact measurements, but rather a subjective estimation. Processing time is measured on a relatively advanced but still <a href="https://subjective.youtrack.cloud/articles/DVE-A-7/Original-Setup">a regular PC</a>.</p>
<p>Whisper produces 3 text files: <code>.txt</code>, <code>.str</code>, and <code>.vtt</code>. The <code>.vtt</code>, while could contain additional metadata (such as chapters), in this particular case does not contain anything but timestamps, which makes it no different from the <code>.srt</code> version. <code>.txt</code> can be easily generated from <code>.srt</code>, so essentially only the <code>srt</code> file should be saved.</p>
<h2 id="decision">Decision</h2>
<p>The following structure is implemented around the transcript manufacturing process.</p>
<h3 id="transcript-flow">Transcript Flow</h3>
<p>Transcript flow consists of 4 inter-related scripts:</p>
<ul>
<li><a href="https://github.com/neledov/autobox/blob/main/transfactory.py">transfactory</a>, which produces transcripts from audio files;</li>
<li><a href="https://github.com/betterthanever2/wapaganda_tools/blob/master/trans/transsuply.py">transsuply</a>, which sees to it that there were always enough files for processing;</li>
<li><a href="https://github.com/betterthanever2/wapaganda_tools/blob/master/trans/transprocessor.py">transprocessor</a>, which downloads the <code>factory</code>'s output and saves it to final storage ;</li>
<li><a href="https://github.com/betterthanever2/wapaganda_tools/blob/master/trans/transcleanup.py">transcleanup</a>, which removes processed audio and text files.</li>
</ul>
<p>The flow is described in more detail in DVE-A-40.</p>
<h3 id="storage">Storage</h3>
<p>The following storage units are used for temporary and permanent storage:</p>
<ul>
<li><strong>MongoDB</strong> (cluster <code>wapaless</code>, collection <code>transcripts</code>) that contains objects of the structure:</li>
</ul>
<p><code>json
  {
    "supa_table": str "{segment_name}_vids",
    "supa_id": int,
    "whisper_model": str "l" | "s" | "m",
    "duration": dict {"total": int}, # in seconds
    "text": str "full_text",
    "srt": dict {("chunk_start_time-chunk_end_time"): "chunk_text"}
  }</code>
* <span style="background-color:mistyrose;"></span>Supabase storage, bucket <code>prabyss</code>. Used for temporary storage of audio files and resulting <code>.srt</code> files
* Supabase storage, bucket <code>back-backups</code>. Used to store all the backups (not just transcripts) as <code>pickle</code> objects.</p>
<h3 id="auxiliary-database">Auxiliary database</h3>
<ul>
<li>Supabase DB, schema <code>service</code>, table <code>prabyss</code>. Used to store information on the media episodes to be transcribed, as well as a data exchange point between different parts of the transcript flow.</li>
</ul>
<p>Additional technical information can be found <a href="https://subjective.youtrack.cloud/articles/DVE-A-26/RFC-2-Transcripts">here</a> and <a href="https://subjective.youtrack.cloud/articles/DVE-A-22/Supabase-Storage">here</a>.</p>
<h2 id="status">Status</h2>
<p>Accepted</p>
<h2 id="consequence">Consequence</h2>
<p>This infrastructure is relatively strict and predictable, but also adjustable. In the near future, it would allow an easier implementation of full text search over the large amounts of text. In the more distant future, it would also allow NLP-based analysis and/or translation into English.</p>
    <nav id="page-controls">
      <a href="#content" id="return-top">
        <i class="fa fa-arrow-up" alt="â‡§"></i> Return to top
      </a>
    </nav>
  </main>
  </content>
  <footer id="footer">
    

<p>Compiled from markdown using <a href="https://www.mkdocs.org/">MkDocs</a>. Theme is <a href="https://teparsons.github.io/mkdocs-landing/">Landing</a> by <a href="https://toddparsons.co.uk">Todd Parsons</a>.</p>














<script src="../../search/main.js"></script>

  </footer>
</body>

</html>