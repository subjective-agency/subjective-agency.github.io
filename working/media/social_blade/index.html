
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Social Blade Addition - Wapaganda Project Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#relevant-sections" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Wapaganda Project Docs" class="md-header__button md-logo" aria-label="Wapaganda Project Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wapaganda Project Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Social Blade Addition
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../apps/" class="md-tabs__link">
        
  
    
  
  Applications

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../architecture/" class="md-tabs__link">
        
  
    
  
  ADRs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../infra/" class="md-tabs__link">
        
  
    
  
  Infrastructure

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../db/" class="md-tabs__link">
          
  
    
  
  Database

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Wapaganda Project Docs" class="md-nav__button md-logo" aria-label="Wapaganda Project Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Wapaganda Project Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Applications
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADRs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Database
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/new_table_checklist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    New Table Checklist
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relevant-sections" class="md-nav__link">
    <span class="md-ellipsis">
      Relevant sections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approximate-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Approximate Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observations" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-do" class="md-nav__link">
    <span class="md-ellipsis">
      To do
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upd1" class="md-nav__link">
    <span class="md-ellipsis">
      UPD1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upd2" class="md-nav__link">
    <span class="md-ellipsis">
      UPD2
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Social Blade Addition</h1>

<p>SocialBlade is a platform collecting statistics on various media platforms, including Youtube. SocialBlade data would compliment the youtube stats data we have currently. SocialBlade data is NOT free, so related flow should be designed to draw maximum value from what we get.</p>
<p>Attached is a standard result you'd get if you spend 1 credit on a channel. Historical data is available for additional creds.</p>
<h2 id="relevant-sections">Relevant sections</h2>
<table>
<thead>
<tr>
<th>Section</th>
<th>Datatype</th>
<th>Notes</th>
<th>Where</th>
</tr>
</thead>
<tbody>
<tr>
<td>info -&gt; access -&gt; expires_at</td>
<td>Datetime</td>
<td>Service item that should be used to manage how a channel data would be updated further</td>
<td></td>
</tr>
<tr>
<td>data -&gt; id</td>
<td>JSON[TEXT]</td>
<td>Data item that should be parsed and saved once</td>
<td>youtube_channels</td>
</tr>
<tr>
<td>data -&gt; general -&gt; created_at</td>
<td>Datetime</td>
<td>Data item that should be parsed and saved once. Only needed for unresolved channels</td>
<td>youtube_channels</td>
</tr>
<tr>
<td>data -&gt; general -&gt; geo</td>
<td>JSON[TEXT]</td>
<td>Data item that should be parsed and saved once</td>
<td>youtube_channels</td>
</tr>
<tr>
<td>data -&gt; general -&gt; branding -&gt; social</td>
<td>JSON[TEXT]</td>
<td>Should be re-checked on every request.</td>
<td>youtube_channels</td>
</tr>
<tr>
<td><del>statistics -&gt; total</del></td>
<td>JSON[TEXT/INT]</td>
<td>Contains 3 keys - uploads, subscribers and views with values current as of the moment of request.<br/><br/>Values for subs and views are the same as the most recent <code>daily</code> values.<br/>Value for current number of uploaded vids can be procured from Youtube API for free.</td>
<td>nowhere</td>
</tr>
<tr>
<td>statistics -&gt; growth</td>
<td>JSON[TEXT/INT]</td>
<td>It's not exactly clear what these numbers signify. Growth over the first year of existence? What's the deal with the negative values?<br/>TBD</td>
<td></td>
</tr>
<tr>
<td>ranks</td>
<td>JSON[TEXT/INT]</td>
<td>Data is relevant as of the moment of request. Not included in daily</td>
<td></td>
</tr>
<tr>
<td>daily</td>
<td>JSON[TEXT/INT]</td>
<td>With 1 credit we get number of subs and views over previous 30 days</td>
<td>youtube_stats</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>Reconciliation required for stats data currently stored in <code>youtube_vids</code>. It gets fetched via Youtube API, and contains numbers for views, comments and likes on specific videos (as of the moment of request).</li>
<li>Stats data stored in <code>youtube_channels</code> should be the most current, and should be updated from <code>youtube_stats</code> table data.</li>
</ul>
<h2 id="approximate-flow">Approximate Flow</h2>
<ol>
<li>Fetch a channel from the database.</li>
<li>Get max amount of historical data on this channel.</li>
<li>Parse and save the data to the database. We would get:</li>
<li><code>expires_at</code> date;</li>
<li><code>general</code> information that we only need once;</li>
<li>related <code>social</code> network accounts;</li>
<li><code>growth</code> data;</li>
<li><code>ranks</code> data relevant as of the moment of request;</li>
<li>complete set of <code>daily</code> data up to the date of request.</li>
<li>If a channel is defunct, this is the end of it.</li>
<li>If a channel is not defunct:</li>
<li>Set new value for <code>expires_at</code> date (TBD)</li>
<li>Fetch updates on this channel until <code>expires_at</code> date comes. With every response we would get:<ul>
<li>related <code>social</code> network accounts (possible update);</li>
<li><code>growth</code> data; (possible update?) (to be saved?)</li>
<li><code>ranks</code> data relevant as of the moment of request; (to be saved)</li>
<li><code>daily</code> data for previous 30 days (items not in db to be saved)</li>
</ul>
</li>
<li>Put channel on pause for 30 days. At this point we have:<ul>
<li>most current list of related <code>social</code> accounts;</li>
<li><code>ranks</code> data for the recent 30 days;</li>
<li><code>growth</code> data for the recent 30 days;</li>
<li>entire set of <code>daily</code> data up until current date.</li>
</ul>
</li>
<li>After 30 days, spend 1 credit on this channel to fetch the standart amount of data. We would get:<ul>
<li>related <code>social</code> network accounts (possible update);</li>
<li><code>growth</code> data; (possible update?) (to be saved?)</li>
<li><code>ranks</code> data relevant as of the moment of request; (to be saved)</li>
<li><code>daily</code> data for previous 30 days (to be saved).</li>
</ul>
</li>
<li>Put channel on pause for 30 days. At this point we have:<ul>
<li>most current list of related <code>social</code> accounts;</li>
<li><code>ranks</code> data for 60 days in total: 30 days of the 1st iteration, and 30 more of the 2nd iteration;</li>
<li><code>growth</code> data for 60 days; (...)</li>
<li>entire set of <code>daily</code> data up until current date.</li>
</ul>
</li>
<li>Rinse and repeat.</li>
</ol>
<h2 id="observations">Observations</h2>
<ul>
<li>We would have consistent and steady set of <code>daily</code> data with no gaps.</li>
<li>We would have inconsistent set of <code>ranks</code> data - 30 days stretches with 30 days gaps in between.</li>
<li>Value of <code>growth</code> data is dubious at the moment.</li>
</ul>
<h2 id="to-do">To do</h2>
<ul>
<li>Find a place for <code>expires_at</code> timestamp;</li>
<li>Create a table for storing <code>daily</code> data. Possibly, store <code>ranks</code> (and <code>growth</code>?) data in the same table;</li>
<li>Decide what to do with videos-level stats;</li>
<li>Set up a trigger to update <code>youtube_channels</code> table with most current views, subs etc.</li>
</ul>
<h2 id="upd1">UPD1</h2>
<p>After reviewing the video https://www.youtube.com/watch?v=LihUTkSMRFw found by @saszko, it became clear to me that the actual flow should be as follows:</p>
<div class="language-text highlight"><pre><span></span><code>Get a channel from database;
Consider channel&#39;s creation date.
    If creation_date is less than 700 days ago, do nothing.
    If creation_date is more than 700 days ago, spend 3 credits to retrieve max amount of historical data from SocialBlade.
Put the channel up for update via the compare flow (TBD)

if channel is defunct - one time;
if channel is not defunct - continuously on schedule;
</code></pre></div>
<p>The compare flow would be based on the info from the aforementioned video, and would involve using playwright for access to https://socialblade.com/youtube/compare page (it returns 503 to requests ). Example compare URL is https://socialblade.com/youtube/compare/UCBMXxadAHZl9FOGhMeR_ptg/UCKgdkhHgBQrwWY_PVGxMH9Q, where pieces after compare/ are identifiers of Youtube channels. With this tool, you can retrieve up to 3 channels at a time.</p>
<p>Retrieval algorythm is approximately as follows:</p>
<div class="language-text highlight"><pre><span></span><code>Get 3 target channels from the database accounting for 1) if the channel is defunct; 2) when was it last updated.
Shape compare URL.
Use playwright to visit the URL and retrieve page&#39;s source code
Parse the source code to retrieve 5 relevant raw strings corresponding to 5 sections returned by the compare module.
Parse raw strings into proper data structures
Persist only new items to the database.
</code></pre></div>
<h2 id="upd2">UPD2</h2>
<p>With the compare flow, only 2 sections (raw strings) are relevant:</p>
<div class="language-text highlight"><pre><span></span><code>document.getElementById(&#39;subscribersYTDYGraph&#39;)
document.getElementById(&#39;videoviewsYTDYGraph&#39;)
</code></pre></div>
<p>Of the other 4, dailysubscribersYTDYGraph and dailyvideoviewsYTDYGraph represent a diff between days, which we can calculate ourselves; and futuresubsYTDYGraph and futureviewsYTDYGraph are projections based on unknown algorythm, which makes them rather useless.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>